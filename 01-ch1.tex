\chapter{绪论}

\section{选题背景与研究意义}
近年来，在电子商务高速发展和网络技术不断进化的大环境下，移动支付这一新兴的概念，在互联网金融业务和移动网络交叉融合下产生，凭借其移动性、便携性和及时性，颠覆了传统的基于银行和纸币的交易方式，给当下大众的支付消费习惯带来巨大影响。\cite{mobilepaymentrisk}

在一个典型的移动支付的交易场景中，交易双方首先在线下商量好交易金额，然后通过某一支付服务提供方进行转账操作，在此过程中不需要用户进行现金的交易，款项的转移在支付服务提供方的云服务器中完成，也可能涉及到和银行方的交互。

由于移动支付服务依托于云计算，其也会受到一般云计算服务可能遇到的风险，包括内部人员监守自盗，或是外部攻击人员成功获取到密钥后解密加密过的信息\cite{lastpass}。一旦交易信息泄露，攻击者可以轻易推断用户的各种敏感信息，例如：支付能力、信用情况和消费习惯等。因此，对交易金额等敏感数据的恰当处理，在官方监管机构的要求下，已经成为如今支付服务的必须安全标准之一。\cite{gov_pay}

% 研究意义
本文着手于在用户交易过程中，通过同态加密等密码学工具，确保用户的交易金额只由交易双方知道而不泄露给第三方。于此核心目的之上，通过 R-LWE 的重加密方法\cite{Mouchet2020LattigoAM,lattigoRepo}实现了交易的正确性，也使用了 CKKS 支持对浮点数进行同态运算的特性为交易手续费的计算留下了空间。基于 CKKS 方案对用户交易数据隐私保护的研究，有助于后人拓展和提出更完备，同时也具有更强功能性的交易隐私保护方案，也有助于提高用户对移动支付的信任度。

% FIXME: 可能需要合并/重写

\section{国内外研究现状}

同态加密指的是一类允许对密文进行特定运算的算法，用户将个人敏感数据加密后存储在一个不可信的服务器中，允许服务器在没有私钥，不了解明文的情况下，完成对密文的处理任务，并给出正确的查询应答。\cite{FHEResearch,rivest1978data}

对全同态加密的研究自 2009 年 Craig G. 的重大突破以来\cite{homenc}已经取得了十分显著的进展。越来越多具有更优秀性能和更多特性的全同态加密方案，以及他们的优化方案被提出，其中具有代表性的包括基于 LWE 问题的 BFV 加密方案和基于近似特征向量的 FHEW 和 TFHE 方案\cite{cryptoeprint:2011/344,cryptoeprint:2011/277,cryptoeprint:2012/144,fhew,TFHE}。

2017年，首尔大学的学者 Cheon 等人提出了一个基于 R-LWE 的全同态加密方案 HEAAN\cite{cryptoeprint:2016/421}，并在随后的研究里分别提出了其自举算法和优化方案等\cite{cryptoeprint:2018/153,cryptoeprint:2018/931}。与前人的工作不同的是，Cheon 等人的成果将全同态加密的明文空间拓展至了全体复向量域，而在此之前只有对整数明文进行加密的的全同态加密方案。Cheon 等人的成果使全同态加密的实际应用范围得到了极大的扩展，包括隐私机器学习等。\cite{FL_HE}

随着全同态加密方案的研究不断成熟，越来越多的全同态加密库被发布，如微软的 SEAL\cite{sealcrypto}、IBM 的 HELib，以及由开源社区维护的 OpenFHE\cite{OpenFHE} 和 Lattigo\cite{Mouchet2020LattigoAM} 等。这些全同态加密密码学库的发布标志着全同态加密技术正在从理论阶段向应用阶段进行转换\cite{ZQL-SEAL}，对推动学者进行相关领域实际应用的研究有着重大实际意义。

包括部分同态加密在内的加密方案的同态性，吸引了许多学者对其在实践应用方面进行研究。2018 年，徐文玉等学者在文献\cite{Homo_Medi}提出了一个结合区块链和同态加密的电子医疗记录隐私保护方案，实现了保险公司等第三方在无法获取客户明文医疗记录的情况下，仍然可以判断是否理赔的功能。

于此同时，也有许多其他将同态加密和其他隐私保护方法结合的方案被提出。2020 年，姜轶涵等人在他的文献里\cite{ACT}运用了同态加密、零知识证明和数字签名等密码学手段，提出了一个密态可审计交易方案。结合这些手段，该方案保证了交易数据隐私和正确性，同时也满足了可审计性。2022 年，学者周星光提出了另一个面向航空差旅消费的可监管的交易隐私保护方案。\cite{ZXG_Air_privacy}该方案在 Boneh 等人基于身份的公钥加密方案上进行了拓展，并利用双公钥方案和零知识证明方案，实现了高效的监管方和交易双方之间的核算，在引入了额外接收方的前提下依然能够高效运行。

\section{本文主要研究内容}

本文基于全同态加密方案 CKKS\cite{cryptoeprint:2016/421} 和 ECDSA 数字签名方案，设计了一个具备交易金额隐私保护的支付方案，保证交易金额的隐私性和正确性。本文也基于该方案，提出了一个使用 Golang 编写的简单库实现。该库在客户端方面实现了对交易的加密和解密，对交易信息的签名等；在服务端库中实现了对交易数据的验证，密钥转换和同态账户的余额更新等操作。此外亦配套了一个简单的服务端实现。

本文主要研究内容为：

\begin{enumerate}
    \item 对现有的交易隐私保护方法和全同态加密算法进行了简要的研究，了解了目前全同态加密算法的局限性；对所使用算法所基于的困难问题 R-LWE 亦进行了简要的调研。
    \item 根据方案的安全需求和功能需求，确定了方案的技术路线；使用 Golang 进行基本函数的代码实现，并使用 SQLite3 进行用户和交易数据的存储，使用 http 协议进行客户端和服务端之间的通信。
    \item 研究了方案依赖的全同态加密密码学库 Lattigo\cite{lattigoRepo}，了解了 Lattigo 的 CKKS 子模块和 RLWE 子模块，及模块内暴露\footnote{又称“被导出（Exported）”或“公有的 （Public）”，在软件工程领域中指外部可以访问的函数，和私有的（Private）相对，后者不可以由外部程序调用而只能被库内的方法调用}的方法，为后续的方案实现做准备。
    \item 编写了一个简单的库实现，并附有集成的单元测试。
\end{enumerate}

\section{论文结构安排}

本文共分为六章，具体内容如下：

第一章：绪论。该章节介绍了本文的研究背景和意义，介绍了目前全同态加密的研究进展，以及其当前在隐私保护领域的应用，以及本文的主要研究内容和结构安排。

第二章：基础知识。该章节包括了对本文提出的方案所使用的技术路线、密码学工具等的介绍，包括全同态加密、环上的误差还原问题、CKKS 方案及使用的密码学库 Lattigo 的相关介绍进行阐述。

第三章：交易金额隐私保护的支付方案设计。这一章主要包括了方案的需求分析、构造、隐私保护能力和安全性分析，其中方案构造部分阐述了方案的基本假设和交易各阶段。

第四章：实验评估。对本文提出的交易金额隐私保护方案的样例实现进行描述、测试实验和分析实验结果。

第五章：总结和展望。对本文的成果和不足进行总结和展望。
